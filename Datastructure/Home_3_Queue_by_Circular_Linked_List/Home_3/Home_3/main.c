#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define FIRST 0
#define LAST -1
#define ERROR -2

typedef struct _Node{
	char name[10];
	char tel[11];
	struct _Node* link;
} Node;		//Node?? ???? Struct

typedef struct _Circular{
	Node *initPnt;
	int length;
} Circular;	//??????????? ???? Struct

void initCircular(Circular *list);								//Circular ????? ????
void insert(Circular *list, char *name, char *tel, int index);	//????
void eject(Circular *list, int index);							//????
int checkLength(Circular list);									//??? ???? ???
int checkPriority(Circular list, char *name);					//??? ???(?????)?? ?????? ???? ????? ???? ???
void print(Circular list);										//??? Circular ? ??? ???

int main() {
	Circular waiting;
	initCircular(&waiting);	//????
	print(waiting);			//???? ? ???
	
	insert(&waiting, "?????", "123-456", LAST);	//???: ?????, ?????: 123-456?? ?????? ??? ??? ???????? ???
	print(waiting);									//???
	
	insert(&waiting, "??øª", "234-567", LAST);	//???: ??øª, ?????: 234-567?? ?????? ??? ??? ???????? ???
	print(waiting);									//???
	
	checkPriority(waiting, "?????");				//????? ??????? ????? ??? ???? ???
	checkPriority(waiting, "??øª");				//????? ??øª?? ????? ??? ???? ???
	
	insert(&waiting, "VIP", "345-678", FIRST);		//???: VIP, ?????: 345-678
	print(waiting);


	insert(&waiting, "VVIP", "000-000", FIRST);		//???: VVIP, ?????: 000-000
	print(waiting);

	eject(&waiting,FIRST);	//? ???(???? ??????? ?????? ???) ????
	print(waiting);			//???

	//printf("%d\n", checkLength(waiting));
	eject(&waiting, LAST);	//? ???(???? ??????? ?????? ???) ????
	print(waiting);			//???

	system("pause");
}

void initCircular(Circular * list) {
	list->initPnt = NULL;
	list->length = 0;
}

void insert(Circular *list, char* name, char* tel, int index) {
	if (index > list->length) {
		printf("ERROR: ?¥å????? ??????? ??????? ????.\n");
		return;
	}
	
	Node *newNode = (Node *)malloc(sizeof(Node));	//Create space of newNode
	strcpy(newNode->name, name); //Initiate newNode(name)
	strcpy(newNode->tel, tel); //Initiate newNode(tel)
	newNode->link = NULL; //Initiate newNode(link)

	Node *temp;
	
	if (list->initPnt == NULL) {	//Case 1: ??????? NULL
		newNode->link = newNode;
		list->initPnt = newNode;
		list->length++;
	}
	else if (index == FIRST) {		//Case 2: FIRST insert
		newNode->link = list->initPnt->link;
		list->initPnt->link = newNode;
		list->length++;
	}
	else if (index == LAST) {		//Case 3: LAST insert
		newNode->link = list->initPnt->link;
		list->initPnt->link = newNode;
		list->initPnt = newNode;
		list->length++;
	}
	else {							//Case 4: ??? index ???? ???? insert
		temp = list->initPnt->link;
		for (int i = 0; i < index; i++) temp = temp->link; //???? ?????? ???? ???? ????? ??? ??????? ????
		newNode->link = temp->link;
		temp->link = newNode;
		list->length++;
	}
	printf("%s ????\n",newNode->name);
}

void eject(Circular *list, int index){
	Node *temp;		//???? ?????? ???? ???
	Node *target;	//???? ?? ???

	if (index == FIRST) {	//????? Front?? ????? ??? ??????? ???
		target = list->initPnt->link;
		list->initPnt->link = target->link;
		printf("%s ??? ????\n", target->name);
		list->length--;
		free(target);
		return;
	}
	else if (index == LAST) {	//????? Rear?? ????? ??? ??????? ???
		index = list->length;	//index???? Node?? ????????? ????
	}

	temp = list->initPnt;				//index ????? ??? ????

	for (int i = 0; i < index-1; i++) {	//index?? 0???? ??? -> index-1 ??? ???
		temp = temp->link;	//???? ????? ???? ??? ???
	}

	target = temp->link;	//???? ??? ????(??????? ???? ????? ???????)

	temp->link = target->link;
	if (index == list->length) list->initPnt = temp;	//?????? ??? ?????? ??????(initPnt) ????
	list->length--;
	printf("%s ??? ????\n", target->name);
	free(target);
}

int checkLength(Circular list){	//???? ???
	return list.length;
}

int checkPriority(Circular list, char *name){
	Node *temp = list.initPnt->link;	//? ??? ??????? ???
	for (int i = 0; i < list.length; i++) {
		if (!strcmp(temp->name, name)) {
			printf("%s?? ?ÄØ?????? %d????. \n", temp->name, i);
			return i;
		}
		else temp = temp->link;			//name?? ??????? ?????? ?????? ???? ???? ???
	}
	printf("???????? ??? ???????. \n");		//?????? name?? ???? ???
	return ERROR;
}

void print(Circular list)	//? ???
{
	if (list.length == 0) {	//??? ?????? ????
		printf("NULL \n");
		return;
	}
	Node *temp = list.initPnt->link;	//? ?????? ???
	for (int i = 0; i < list.length; i++) {
		printf("???: %s, ?????: %s | ", temp->name, temp->tel);
		temp = temp->link;
	}
	printf("NULL \n");
}
